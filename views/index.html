<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>PubNub Chat Demo with OAuth & PubNub Access Manager</title>
	<meta name="description" content="Simple Chat Room">
	<meta name="author" content="Tomomi Imura  @girlie_mac">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href='//fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="css/style.css">
	<script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
</head>

<body>
	<% if (!user) { %>
	<header class="title">
		<img class="logo" src="images/pubnub-secure-chat.png">
	</header>

	<section id="login">
		<p>Yo, you need to <span>login</span> to chat!</p>
		<a href="/login" class="button"><i class="fa fa-github"></i> Login with GitHub</a>
	</section>

	<section id="main" role="main" hidden>

	<% } else { %>
	<header>
		<h1>PubNub Access Manager Chat Demo</h1>
	</header>

	<section class="row">
		<div id="vid-view" style="text-align: center;">
			<video id="local-video" style="width:48%;" class="major-box" autoplay="autoplay" muted="true"></video>
			<video id="remote-video" style="width:48%;" class="major-box" autoplay="autoplay"></video>
		</div>
	</section>

	<section id="main" role="main">
		<p class="me"><img src="<%= user._json.avatar_url %>" class="avatar" align="left"><%= user.displayName %> (<%= user.username %>)</p>
	<% } %>
	
		<div id="chat">
			<input type="text" id="input" name="text" placeholder="Type your message..." required>
			<input type="button" id="send" value="Send" />
		</div>
		<p id="presence"></p>
		<p id="action"></p>
		<div id="output"></div>
	</section>

	<footer>
		Green Vector Background by <a href="http://vectorportal.deviantart.com/art/Green-Vector-Background-209349858">Vectorportal</a> CC-BY 3.0 
	</footer>


	<script src="//cdn.pubnub.com/sdk/javascript/pubnub.4.13.0.min.js"></script>
	<script src="js/ecc-0.3.min.js"></script>

	<script>
	<% if (user) { %>
		window.user = {id:"<%= user.id %>", username: "<%= user.username %>", avatar: "<%= user._json.avatar_url %>", accessToken: "<%= user.accessToken %>", eccKey: "<%= user.eccKey %>", xirsys: '<%- user.xirsys %>'};
	<% } %>
	</script>

	<script src="js/app.js"></script>
	
</body>
</html>